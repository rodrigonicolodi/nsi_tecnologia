<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Impress√£o OS <%= os.numero_os || os.id %></title>
  <link rel="stylesheet" href="/css/cupom-print.css">
  <script>
    // Controles simples apenas para impress√£o
    function imprimir() {
      window.print();
    }
    
    function fechar() {
      window.close();
    }
  </script>
  <style>
    @page {
      size: 80mm auto;
      margin: 0;
      color-adjust: exact;
      -webkit-print-color-adjust: exact;
    }

    body {
      width: 80mm;
      margin: 0;
      padding: 0;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      line-height: 1.1;
      overflow: hidden !important;
      height: auto !important;
      box-sizing: border-box;
      background: white;
      color: #000 !important;
      font-weight: bold;
    }

    /* Usar apenas o CSS do cupom-print.css */

    /* Ajustes para impress√£o */
    @media print {
      body {
        font-size: 13px;
        line-height: 1.1;
        margin: 0;
        padding: 0;
      }
      
      /* Ocultar controles na impress√£o */
      div[style*="position: fixed"] {
        display: none !important;
      }
      
      .cupom-print {
        padding: 3mm !important;
        margin: 0 !important;
      }
      
      /* For√ßar TODO o texto em negrito */
      .cupom-print, .cupom-print * {
        font-weight: bold !important;
        color: #000 !important;
      }
      
      /* Remover tarja preta do total */
      .cupom-total {
        background: transparent !important;
        color: #000 !important;
        border: 2px solid #000 !important;
      }
    }
  </style>
</head>
<body>
  <!-- Controles simples -->
  <div style="position: fixed; top: 20px; right: 20px; z-index: 1000; background: white; padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
    <button onclick="imprimir()" style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 3px; cursor: pointer; margin-right: 5px;">
      üñ®Ô∏è Imprimir
    </button>
    <button onclick="fechar()" style="background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 3px; cursor: pointer;">
      ‚ùå Fechar
    </button>
  </div>
  
  <div class="cupom-print" style="padding: 12mm; margin-top: 60px;">
    <div class="cupom-titulo">ORDEM DE SERVI√áO</div>
    <div class="cupom-numero">N¬∫ <%= os.numero_os || os.id %></div>
    <div class="cupom-linha"></div>

    <div class="cupom-cliente"><strong>Cliente:</strong> <%= os.cliente_nome || 'N/D' %></div>
    <div class="cupom-cliente"><strong>Data:</strong> <%= os.data_abertura ? new Date(os.data_abertura).toLocaleDateString('pt-BR') : 'N/D' %></div>
    <div class="cupom-cliente"><strong>Status:</strong> <%= os.status || 'N/D' %></div>

    <div class="cupom-linha"></div>

           <div class="cupom-servico">
             <strong>Servi√ßos:</strong><br>
             <%- (os.descricao_servico || os.tipo_servico || 'N/D')
               .replace(/\r?\n/g, '<br>') %>
           </div>

    <div class="cupom-servico">
      <strong>Problema informado:</strong><br>
      <%- (os.problema_informado || 'N/D')
        .replace(/\r?\n/g, '<br>') %>
    </div>

    <div class="cupom-linha"></div>

    <div class="cupom-valor"><strong>Servi√ßos:</strong> R$ <%= parseFloat(os.valor_servico || os.valor || 0).toFixed(2) %></div>
    <div class="cupom-valor"><strong>Desconto:</strong> R$ <%= parseFloat(os.desconto || 0).toFixed(2) %></div>
    <div class="cupom-valor"><strong>Produtos:</strong> R$ <%= parseFloat(os.acrescimos || 0).toFixed(2) %></div>
    
    <div class="cupom-total">TOTAL: R$ <%= parseFloat(os.valor_total || 0).toFixed(2) %></div>

    <div class="cupom-linha"></div>
    <div class="cupom-rodape">Obrigado pela prefer√™ncia!</div>
  </div>
</body>
</html>